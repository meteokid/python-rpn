***s/r rdrstrt - Read the restart file
*
#include <model_macros_f.h>
*
      subroutine rdrstrt ()
*
#include "impnone.cdk"
*
*author
*     M. Desgagne - Mars 2000
*
*revision
* v2_00 - Desgagne M.       - initial MPI version
* v2_10 - Desgagne M.       - introduce WA files
* v2_30 - Dugas B.          - call ouvrstrt to open restrart file
* v2_30 - Corbeil L.        - Added reading of pres_surf and pres_top
* v2_31 - Desgagne M.       - Add Tr2d tracers
* v3_00 - Desgagne & Lee    - Lam configuration
*
*object
*	
*arguments
*	none
*
*implicits
#include "lun.cdk"
#include "init.cdk"
#include "rstr.cdk"
#include "lctl.cdk"
#include "schm.cdk"
#include "mem.cdk"
#include "p_bus.cdk"
#include "c_cplg.cdk"
#include "glb_ld.cdk"
#include "tr2d.cdk"
#include "pres.cdk"
#include "pilot.cdk"
*
**
      integer adr,ier,dim,current_nest
      integer vmmckmx,fclos,ouvrstrt
      external vmmckmx,fclos,ouvrstrt
*
*     ---------------------------------------------------------------
*
      Rstri_sdon = 0
*
      if (Lun_rstrt .le. 0) Lun_rstrt = ouvrstrt( )
*
      if (Rstri_rstn_L) then
         call waopen (Lun_rstrt)
         call waread (Lun_rstrt,Lctl_step   ,1,1)
         call waread (Lun_rstrt,Rstri_idon_L,2,1)
         adr = 3
         if (Schm_phyms_L.and.Mem_phyncore_L) then
            call waread (Lun_rstrt,Phy_busper3D,adr,p_bper_siz*p_nj)
            adr = adr + p_bper_siz*p_nj
            call waread (Lun_rstrt,Rstri_half_L,adr,1)
            adr = adr + 1
            if (Init_balgm_L .and. .not.Rstri_idon_L .and. Rstri_half_L)
     $      then
            call hpalloc(Phy_busper3D_digf_,p_bper_siz*p_nj,ier,1)
            call waread (Lun_rstrt,Phy_busper3D_digf,adr,
     $                                 p_bper_siz*p_nj)
            adr = adr + p_bper_siz*p_nj
            endif
         endif 
         call waread (Lun_rstrt, c_cplg_step ,adr, 1)
         adr = adr + 1
         call waread (Lun_rstrt, pres_surf ,adr, 1)
         adr = adr + 1
         call waread (Lun_rstrt, pres_top  ,adr, 1)
         adr = adr + 1
         call waread (Lun_rstrt, current_nest  ,adr, 1)
         call datf2p (Pil_current_S,current_nest)
*
         if ((Tr2d_incore_L).and.(Tr2d_ntr.gt.0)) then
            dim = Tr2d_ntr*LDIST_SIZ*l_nk
            call hpalloc (Tr2d_stk3d_, dim, ier,1)
            adr = adr + 1
            call waread (Lun_rstrt,Tr2d_stk3d,adr,dim)
            if ( Init_balgm_L .and. .not.Rstri_idon_L ) then
               call hpalloc (Tr2d_stk3da_, dim, ier,1)
               adr = adr + dim
               call waread (Lun_rstrt,Tr2d_stk3da,adr,dim)
            endif
         endif
         call waclos(Lun_rstrt)
         ier = fclos(Lun_rstrt)  
      endif
*
*     ---------------------------------------------------------------
*      
      return
      end
