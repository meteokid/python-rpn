***s/r c_fillbus - Fill the slice workspace variable for the physics
*
#include <model_macros_f.h>
*
      SUBROUTINE c_fillbus( F_busdyn, F_busper, F_busvol, F_jdo)
*
      IMPLICIT NONE
      INTEGER F_jdo
*
      REAL F_busdyn(*),F_busper(*), F_busvol(*)
*
*author 
*     Pierre Pellerin - rpn - December 2004
*
*revision
* v3_21 - Sophie Valcke - rpn/cerfacs - June 2005
*
*object
*     Inject surface fields from coupling to affect the physics
*
*arguments
*  Name        I/O                 Description
*----------------------------------------------------------------
* F_busdyn      I       - dynamic bus
* F_busper      I       - permanent bus
* F_busvol      I       - volatile bus
* F_jdo         I       - slice number being processed
*----------------------------------------------------------------
*
*implicits
#include "glb_ld.cdk"
#include "p_bus.cdk"
#include "busind.cdk"
#include "c_cplg.cdk"
*
      INTEGER i, n, ii, indx, idep, il_cnt, il_deb, l_ninj, l_niFjm1
      INTEGER il_n, il_nkm1
*
**
*     ---------------------------------------------------------------
*
*C    2D variables: extract row F_jdo 
*
      il_cnt = 0
      il_n = 1
      l_ninj = l_ni*l_nj
      il_nkm1 = l_ninj*(l_nk-2)
      l_niFjm1 = l_ni*(F_jdo-1)
        IF (C_cpld2atmos_L) THEN
          IF (iga_n_t8a(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_t8a(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(tmoins+il_nkm1+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_u8a(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_u8a(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(umoins+il_nkm1+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_v8a(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_v8a(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(vmoins+il_nkm1+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_h8a(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_h8a(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(humoins+il_nkm1+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_p8a(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_p8a(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(pmoins+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fba(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fba(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busper(flusolis+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fia(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fia(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busper(fdsi+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_rta(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_rta(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busvol(rt+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
CSV          IF (iga_n_mca(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_mca(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busvol(rt+indx) = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
      ENDIF
      IF (C_cpld2land_L) THEN
          IF (iga_n_fcl(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fcl(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fccpl+(ig_indx_soil-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fcg(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fcg(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fccpl+(ig_indx_glacier-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fvl(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fvl(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fvcpl+(ig_indx_soil-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fvg(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fvg(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fvcpl+(ig_indx_glacier-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
CSV          IF (iga_n_bml(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_bml(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(bmcpl+(ig_indx_soil-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_bmg(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_bmg(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(bmcpl+(ig_indx_glacier-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_all(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_all(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(alcpl+(ig_indx_soil-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_alg(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_alg(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(alcpl+(ig_indx_glacier-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_tgl(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_tgl(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(tgcpl+(ig_indx_soil-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_tgg(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_tgg(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(tgcpl+(ig_indx_glacier-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
          IF (iga_n_mcl(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_mcl(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(mccpl+(ig_indx_soil-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_mcg(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_mcg(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(mccpl+(ig_indx_glacier-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
      ENDIF
      IF (C_cpld2ocean_L) THEN 
          IF (iga_n_glw(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_glw(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busper(glsea+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_i8w(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_i8w(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busper(icedp+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_i7w(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_i7w(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busper(tmice+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_tmw(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_tmw(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busper(twater+indx) = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fcw(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fcw(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fccpl+(ig_indx_water-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fci(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fci(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fccpl+(ig_indx_ice-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fvw(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fvw(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fvcpl+(ig_indx_water-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_fvi(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_fvi(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(fvcpl+(ig_indx_ice-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
CSV          IF (iga_n_bmw(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_bmw(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(bmcpl+(ig_indx_water-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_bmi(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_bmi(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(bmcpl+(ig_indx_ice-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_alw(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_alw(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(alcpl+(ig_indx_water-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_ali(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_ali(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(alcpl+(ig_indx_ice-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV      ENDIF
CSV          IF (iga_n_tgw(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_tgw(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(tgcpl+(ig_indx_water-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
CSV          IF (iga_n_tgi(il_n) .gt. 0) THEN
CSV              il_deb  = l_ninj*(iga_n_tgi(il_n)-1) + l_niFjm1
CSV              il_cnt  = il_cnt + 1
CSV              DO i = 1, p_ni
CSV                indx = i-1
CSV                ii = i + p_offi
CSV                F_busdyn(tgcpl+(ig_indx_ice-1)*p_ni+indx) 
CSV     $              = rga_cpl2phy(il_deb+ii)
CSV              END DO
CSV          ENDIF
          IF (iga_n_mcw(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_mcw(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(mccpl+(ig_indx_water-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
          IF (iga_n_mci(il_n) .gt. 0) THEN
              il_deb  = l_ninj*(iga_n_mci(il_n)-1) + l_niFjm1
              il_cnt  = il_cnt + 1
              DO i = 1, p_ni
                indx = i-1
                ii = i + p_offi
                F_busdyn(mccpl+(ig_indx_ice-1)*p_ni+indx) 
     $              = rga_cpl2phy(il_deb+ii)
              END DO
          ENDIF
      ENDIF
C
*
*     ---------------------------------------------------------------
*
      RETURN
      END
