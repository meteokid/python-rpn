!---------------------------------- LICENCE BEGIN -------------------------------
! GEM - Library of kernel routines for the GEM numerical atmospheric model
! Copyright (C) 1990-2010 - Division de Recherche en Prevision Numerique
!                       Environnement Canada
! This library is free software; you can redistribute it and/or modify it
! under the terms of the GNU Lesser General Public License as published by
! the Free Software Foundation, version 2.1 of the License. This library is
! distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
! without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
! PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
! You should have received a copy of the GNU Lesser General Public License
! along with this library; if not, write to the Free Software Foundation, Inc.,
! 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
!---------------------------------- LICENCE END ---------------------------------

!**s/r v4d_nml
!
#include "model_macros_f.h"
!
      integer function v4d_nml (F_namelistf_S)
      use v4dz, only: V4dz_degree,V4dzge_degree,V4dzga_degree 
!
      implicit none
#include <arch_specific.hf>
!
      character* (*) F_namelistf_S
!
!
!author
!     M. Desgagne    - Summer  2006
!
!revision
! v3_30 - Desgagne M.       - initial version
! v4_04 - Tanguay M.        - Staggered version TL/AD 
! v4_40 - Tanguay M.        - Revision TL/AD
!
!object
!  Default configuration and reading namelist var4d
!
!implicits
#include "lun.cdk"
#include "step.cdk"
#include "path.cdk"
#include "tr3d.cdk"
#include "v4dj.cdk"
#include "v4dm.cdk"
#include "v4d_nml.cdk"
      include "v4dg.inc"
!
      integer  fnom
      external fnom
!
      integer nrec,unf
!
!-------------------------------------------------------------------
!
      v4d_nml = -1
!
      if ((F_namelistf_S.eq.'print').or.(F_namelistf_S.eq.'PRINT')) then
         v4d_nml = 0
         if ((V4dg_conf.ne.0).and.(Lun_out.gt.0))  &
            write (Lun_out  ,nml=var4d)
         return
      endif
!
! Defaults values for var4d namelist variables
!
      V4dg_conf     = 0
      V4dg_output_L = .true.
      V4dg_sensib_L = .false.
      V4dg_twin_L   = .false.
      V4dg_4dvar_L  = .false.
      V4dg_sgvc_L   = .false.
!
      V4dg_identity_L = .false.
      V4dg_grd_L      = .false.
      V4dj_mask_L     = .false.     
      V4dg_chum_s     = 'LQ'
      V4dg_sgvc_dt0   = 0
      V4dg_anincr_L   = .false.
!
      V4dg_stepob   = Step_total
      V4dg_inv      = 1
      V4dm_itmax    = 2 
      V4dm_simax    = 2 
!
      V4dz_degree   = 1
      V4dzge_degree = 1
      V4dzga_degree = 1
      V4dg_pruv_L   = .true.
!
      if (F_namelistf_S .ne. '') then
!
         unf = 0
         if (fnom (unf, F_namelistf_S, 'SEQ' , nrec) .ne. 0) goto 6666
         rewind(unf)
         read (unf, nml=var4d   , end = 6655, err=9140)
!
 6655    call fclos (unf)

      endif
!
 6666 v4d_nml = 1
      goto 9999
!
 9140 call fclos (unf)
      if (Lun_out.gt.0) then
         write (Lun_out, 9350)
         write (Lun_out, 8000)
      endif
!
 8000 format (/,'========= ABORT IN S/R v4d_nml.f ============='/)
 9350 format (/,' NAMELIST var4d    INVALID IN FILE: model_settings '/)
!
!-------------------------------------------------------------------
!
 9999 return
      end
