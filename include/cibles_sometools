prgemnml: prgemnml.o
	makemodelbidon prgemnml > bidon.f90 ; $(MAKE) bidon.o ; rm -f bidon.f90 ;\
	$(RBUILD) -obj $(LCLPO)/*.o -o gemprnml_$(BASE_ARCH).Abs -libpath $(LIBPATH) -libappl "gemdyn_main gemdyn modelutils" -librmn $(RMN_VERSION) -libsys $(LIBSYS)
	/bin/rm -f $(LCLPO)/prgemnml.o $(LCLPO)/bidon.o

gemgrid: gemgrid.o
	makemodelbidon gemgrid > bidon.f90 ; $(MAKE) bidon.o ; rm -f bidon.f90 ;\
	$(RBUILD) -obj $(LCLPO)/*.o -o gemgrid_$(BASE_ARCH).Abs -libpath $(LIBPATH) -libappl "gemdyn_main gemdyn modelutils $(COMM) rpn_commstubs$(COMM_VERSION)" -librmn $(RMN_VERSION) -libsys $(LIBSYS)
	/bin/rm -f $(LCLPO)/bidon.o

toc2nml: toc2nml.o
	makemodelbidon toc2nml > bidon.f90 ; $(MAKE) bidon.o ; rm -f bidon.f90 ;\
	$(RBUILD) -obj $(LCLPO)/*.o -o toc2nml -libpath $(LIBPATH) -libappl "descrip" -librmn $(RMN_VERSION) -libsys $(LIBSYS)
	/bin/rm -f $(LCLPO)/bidon.o

MONBINDIR=.
monitor:
	$(MAKE) gem_monitor_end
	$(MAKE) gem_monitor_output
	mv gem_monitor_end gem_monitor_output $(MONBINDIR)

sometools: prgemnml gemgrid toc2nml

allbin: monitor prgemnml gemgrid toc2nml gem
#	$(MAKE) gem V4D="v4d modulopt prof_003"

BINDIR=$(MONBINDIR)
allbincheck:
	if [[ -f $(BINDIR)/gemprnml_$(BASE_ARCH).Abs \
		&& -f $(BINDIR)/gemgrid_$(BASE_ARCH).Abs \
		&& -f $(BINDIR)/toc2nml \
		&& -f $(BINDIR)/gem_monitor_end \
		&& -f $(BINDIR)/gem_monitor_output \
		]] ; then \
		exit 0 ;\
	fi ;\
	exit 1