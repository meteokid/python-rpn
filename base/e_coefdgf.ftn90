!---------------------------------- LICENCE BEGIN -------------------------------
! GEM - Library of kernel routines for the GEM numerical atmospheric model
! Copyright (C) 1990-2010 - Division de Recherche en Prevision Numerique
!                       Environnement Canada
! This library is free software; you can redistribute it and/or modify it 
! under the terms of the GNU Lesser General Public License as published by
! the Free Software Foundation, version 2.1 of the License. This library is
! distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
! without even the implied warranty of MERCHANTABILITY or FITNESS FOR A 
! PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
! You should have received a copy of the GNU Lesser General Public License
! along with this library; if not, write to the Free Software Foundation, Inc.,
! 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
!---------------------------------- LICENCE END ---------------------------------

!**s/r e_coefdgf - Precomputations for horizontal digital filter 
!
      subroutine e_coefdgf ( fnptx, frl, frlc, frcoeff )
!
      implicit none
#include <arch_specific.hf>
!
      integer fnptx
      real frl, frlc, frcoeff(fnptx+1)
!
!author andre methot - cmc - may 95  
!                      after setinic.ftn v0_15, Alain Patoine
!
!revision
! v0_16 - andre methot           - Digital filter initial version
! v1_96 - V. Lee                 - replaced "cddcst.cdk" with "dcst.cdk"
! v1_97 - V. Lee                 - replaced "cdlun.cdk" with "e_times.cdk"
!
!object
!       see above ID
!	
!arguments
!
!______________________________________________________________________
!                    |                                                 |
! NAME               | DESCRIPTION                                     |
!--------------------|-------------------------------------------------|
! fnptx              | SPAN: half of the number of neighbouring        |
!                    |       points to be used by the filter.          |
!                    |                                                 |
! frl                | half of the shortest wave length resolved       |
!                    |                                                 |
! frlc               | cut off wavelength                              |
!                    |                                                 |
! frcoeff            | digital filter coefficients(output)             |
! ______________________________________________________________________
!
!implicits
#include "model_macros_f.h"
#include "dcst.cdk"
!
!modules
!
      real promegc, prwin1, prsum, prwin2, prn
      integer n
!*
      promegc   = (2.0 * Dcst_pi_8) / frlc
      prwin1    = Dcst_pi_8 / real(fnptx + 1)
      frcoeff(1)= promegc*frl / Dcst_pi_8
      prsum     = frcoeff(1)
!
      do n = 1, fnptx
        prn          = real(n)
        prwin2       = prn * prwin1
        prwin2       = sin(prwin2) / prwin2
        frcoeff(n+1) = prwin2 * sin(prn*promegc*frl) / (prn*Dcst_pi_8)
        prsum        = prsum + 2.0 * frcoeff(n+1)
      enddo
!
      do n = 1, fnptx+1
         frcoeff(n) = frcoeff(n) / prsum
      enddo
!
      return
      end
